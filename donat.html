<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sebuah Kejutan untuk Elisa...</title>
    <!-- Import Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <!-- Import Tone.js untuk efek suara -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.min.js"></script>
    <style>
        :root {
            --bg-start: #fff0f5; /* Soft Pink */
            --bg-end: #ffdab9; /* Peach */
            --text-color: #5d4037; /* Coklat tua untuk teks */
            --accent-color: #d4af37; /* Gold */
            --card-bg: rgba(255, 255, 255, 0.7);
            --font-main: 'Poppins', sans-serif;
            --font-handwriting: 'Dancing Script', cursive;
        }

        body {
            font-family: var(--font-main);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
            overflow: hidden;
            position: relative;
        }

        /* Efek Bokeh di Background */
        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 15% 25%, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0) 20%),
                radial-gradient(circle at 80% 10%, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0) 15%),
                radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0) 25%);
            z-index: 1;
        }

        #app-container {
            max-width: 400px;
            width: 90%;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            z-index: 10;
        }

        .scene {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--card-bg);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeIn 1.5s ease-in-out;
            max-height: 90vh; /* Memastikan kartu tidak melebihi layar */
            overflow-y: auto; /* Scroll jika konten kartu terlalu panjang */
        }

        .scene.active {
            display: flex;
        }

        .scene img {
            max-width: 100%;
            height: auto;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid var(--accent-color);
        }

        h1, h2 {
            font-family: var(--font-handwriting);
            color: var(--accent-color);
            font-size: 2.8rem;
            margin: 10px 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        h2 { font-size: 2.2rem; }
        
        p {
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            font-family: var(--font-main);
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0; /* Mencegah tombol mengecil */
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* Efek Hati Berjatuhan */
        .heart {
            position: absolute;
            font-size: 1.5rem;
            color: #ff8fab; /* Pink Hati */
            top: -5vh;
            animation: fall 10s linear infinite;
            z-index: 5;
        }

        @keyframes fall {
            to {
                transform: translateY(105vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Styling untuk Surat Cinta */
        #love-letter {
            display: none;
            flex-direction: column; /* Menggunakan flexbox untuk layout */
            background: #fffaf0; /* Warna kertas */
            color: var(--text-color);
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px 15px 20px 30px; /* Sedikit penyesuaian padding */
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            animation: unfold 1.5s ease-out;
            transform-origin: top center;
            max-height: 85vh; /* Batasi tinggi maksimal surat */
        }
        
        #love-letter-content {
            overflow-y: auto; /* Scroll hanya pada konten surat */
            padding-right: 15px; /* Memberi ruang untuk scrollbar */
        }

        #love-letter h2 {
            font-size: 2.5rem;
            text-align: center;
            flex-shrink: 0;
        }
        
        #love-letter p {
            font-family: var(--font-handwriting);
            font-size: 1.6rem;
            line-height: 1.8;
            text-align: left;
        }
        
        .signature {
            text-align: right !important;
        }

        @keyframes unfold {
            from { transform: scaleY(0) rotateX(90deg); opacity: 0; }
            to { transform: scaleY(1) rotateX(0deg); opacity: 1; }
        }

        /* === PERBAIKAN DI SINI: SCROLLBAR KUSTOM === */
        /* Menyasar semua elemen yang bisa di-scroll */
        .scene::-webkit-scrollbar,
        #love-letter-content::-webkit-scrollbar {
            width: 8px;
        }

        .scene::-webkit-scrollbar-track,
        #love-letter-content::-webkit-scrollbar-track {
            background: rgba(255, 218, 185, 0.2); /* Peach transparan */
            border-radius: 10px;
        }

        .scene::-webkit-scrollbar-thumb,
        #love-letter-content::-webkit-scrollbar-thumb {
            background-color: var(--accent-color); /* Gold */
            border-radius: 10px;
            border: 2px solid #fffaf0; /* Border warna kertas */
        }

        .scene::-webkit-scrollbar-thumb:hover,
        #love-letter-content::-webkit-scrollbar-thumb:hover {
            background-color: #c5a230; /* Gold lebih gelap saat hover */
        }

    </style>
</head>
<body>
    <div id="hearts-container"></div>
    <div id="app-container">

        <!-- Semua Adegan Kenangan -->
        <div id="story-scenes">
            <div class="scene active" id="scene-0">
                <h1>Untuk Elisa, Cintaku</h1>
                <p>Di dalam kotak ini, ada sesuatu yang lebih manis dari donat. Klik untuk memulai perjalanan kita...</p>
                <button onclick="nextScene()">Mulai Petualangan</button>
            </div>
            <div class="scene" id="scene-1"><img src="/img/ken1.jpg" alt="Kenangan Sekolah"><h2>Awal Mula di Sekolah</h2><p>Saat aku si kakak kelas, pertama kali melihatmu. Siapa sangka adik kelas ini yang akan menjadi partner seumur hidup?</p><button onclick="nextScene()">Lanjut ke Babak Baru</button></div>
            <div class="scene" id="scene-2"><img src="/img/ken2.jpg" alt="Awal Pacaran"><h2>15 Oktober 2015</h2><p>Di tanggal ini, cerita kita resmi dimulai. Sebuah langkah awal dari perjalanan yang luar biasa.</p><button onclick="nextScene()">Lihat Janji Kita</button></div>
            <div class="scene" id="scene-3"><img src="/img/ken3.jpg" alt="Tunangan"><h2>15 Juli 2021</h2><p>Sebuah janji serius, satu langkah lebih dekat untuk menghabiskan sisa hidupku bersamamu.</p><button onclick="nextScene()">Menuju Hari Bahagia</button></div>
            <div class="scene" id="scene-4"><img src="/img/ken4.jpg" alt="Pernikahan"><h2>22 Juli 2022: SAH!</h2><p>Hari kemenangan! Saat aku bisa dengan bangga memanggilmu "Istriku". Babak baru kita dimulai.</p><button onclick="nextScene()">Lihat Keajaiban Kita</button></div>
            <div class="scene" id="scene-5"><img src="/img/hanan.jpg" alt="Hanan Lahir"><h2>4 Mei 2023: Hadiah Terindah</h2><p>Keajaiban kecil kita, Hanan, datang melengkapi keluarga kita. Terima kasih telah menjadi Ibu yang hebat untuknya.</p><button onclick="nextScene()">Satu Petualangan Lagi</button></div>
            <div class="scene" id="scene-6"><img src="/img/elisa.jpg" alt="Foto Elisa"><h2>Petualangan Rasa</h2><p>Berkat kamu, aku jadi tahu dunia perseblakan, perglotakan, dan perayaman. Cinta kita tak instan seperti tahu bulat, kan?</p><button onclick="nextScene()">Satu Kejutan Terakhir...</button></div>
            <div class="scene" id="scene-7"><img src="/img/ken6.jpg" alt="Selamat Anniversary"><h2>Happy 3rd Anniversary!</h2><p>Tiga tahun menikah, dan setiap hari bersamamu masih terasa seperti petualangan baru. Aku punya sesuatu untukmu...</p><button onclick="showLetter()">Buka Surat Untukmu</button></div>
        </div>

        <!-- Surat Cinta Tersembunyi -->
        <div id="love-letter">
            <div id="love-letter-content">
                <h2>Untuk Istriku, Elisa...</h2>
                <p>Sayangku,<br><br>
                Tiga tahun sudah kita berlayar bersama dalam bahtera pernikahan, dan petualangan ini jauh lebih indah dari yang pernah kubayangkan. Terima kasih sudah menjadi nahkoda keduaku, menemaniku melewati ombak dan lautan tenang.<br><br>
                Kamu adalah paket lengkap: istri yang luar biasa, ibu yang hebat untuk Hanan, dan partner kuliner terbaik yang mengenalkanku pada keajaiban seblak & glotak. Cintaku padamu itu nyata, lebih nyata dari tagihan  bulanan kita.<br><br>
                Aku mencintaimu lebih dari kamu mencintai ayam, lebih dalam dari kuah seblak, dan lebih manis dari martabak coklat kacang. Terima kasih untuk segalanya. Mari kita lanjutkan petualangan ini sampai kita tua dan ompong bersama.<br><br>
                <span class="signature">Dengan segenap cinta,<br>Suamimu yang paling beruntung,<br>Ardi</span>
                </p>
            </div>
            <button onclick="restart()" style="margin: 15px auto 0;">Ulangi Kenangan Indah</button>
        </div>
    </div>

    <audio id="bg-music" src="/perfect.mp3" loop></audio>

    <script>
        // Tunggu hingga semua konten halaman (DOM) selesai dimuat sebelum menjalankan skrip
        document.addEventListener('DOMContentLoaded', () => {
            // Deklarasi variabel
            let currentScene = 0;
            const scenes = document.querySelectorAll('#story-scenes .scene');
            const storyContainer = document.getElementById('story-scenes');
            const letterContainer = document.getElementById('love-letter');
            const bgMusic = document.getElementById('bg-music');
            let musicPlayed = false;
            let clickSound = null; // Inisialisasi sebagai null

            // Fungsi untuk menginisialisasi suara HANYA setelah Tone.js siap dan ada interaksi
            function initializeSound() {
                if (window.Tone && !clickSound) {
                     clickSound = new Tone.Synth({
                        oscillator: { type: 'sine' },
                        envelope: { attack: 0.005, decay: 0.1, sustain: 0, release: 0.1 }
                    }).toDestination();
                }
            }
            
            // Membuat hati berjatuhan
            const heartsContainer = document.getElementById('hearts-container');
            for (let i = 0; i < 20; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                heart.innerHTML = 'â™¥';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDuration = Math.random() * 5 + 5 + 's';
                heart.style.animationDelay = Math.random() * 5 + 's';
                heart.style.fontSize = Math.random() * 1 + 1 + 'rem';
                heartsContainer.appendChild(heart);
            }

            // Fungsi untuk memainkan musik (membutuhkan interaksi pengguna pertama)
            function playMusic() {
                if (!musicPlayed) {
                    // Memastikan Tone.start() dipanggil setelah interaksi
                    if(window.Tone) {
                        Tone.start(); 
                        initializeSound(); // Inisialisasi suara saat musik dimulai
                    }
                    bgMusic.play().catch(e => console.log("Autoplay musik dicegah oleh browser."));
                    musicPlayed = true;
                }
            }

            // Fungsi untuk memainkan suara klik
            function playClickSound() {
                // Hanya mainkan suara jika sudah diinisialisasi
                if (clickSound) {
                    clickSound.triggerAttackRelease('C5', '8n');
                }
            }

            // Fungsi untuk menampilkan adegan tertentu
            function showScene(index) {
                scenes.forEach((scene, i) => {
                    scene.classList.toggle('active', i === index);
                });
            }
            
            // Membuat fungsi dapat diakses secara global oleh atribut onclick di HTML
            window.nextScene = function() {
                playMusic();
                playClickSound();
                if (currentScene < scenes.length - 1) {
                    currentScene++;
                    showScene(currentScene);
                }
            };

            window.showLetter = function() {
                playMusic();
                playClickSound();
                storyContainer.style.display = 'none';
                letterContainer.style.display = 'flex'; // Menggunakan flex untuk layout
            };

            window.restart = function() {
                playClickSound();
                letterContainer.style.display = 'none';
                storyContainer.style.display = 'block';
                currentScene = 0;
                showScene(currentScene);
            };
            
            // Memulai dengan menampilkan adegan pertama
            showScene(0);
        });
    </script>
</body>
</html>
